---
# https://goreleaser.com/customization/dist/
dist: ./dist

# https://goreleaser.com/customization/env/
env:
  - OS_DIST={{ .Env.OS_DIST }}
  - OS_DIST_VER={{ .Env.OS_DIST_VER }}
  - OS_DIST_PKG={{ .Env.OS_DIST_PKG }}

# https://goreleaser.com/customization/builds/#import-pre-built-binaries
builds:
  - id: prebuilt
    builder: prebuilt
    goos:
      - linux
    goarch:
      - amd64
      - arm64
    prebuilt:
      path: "/usr/local/bin/{{ .ProjectName }}_{{ .Arch }}"
    binary: "{{ .ProjectName }}"

# https://goreleaser.com/customization/nightlies/
nightly:
  name_template: "{{ .Tag }}"
  publish_release: false

# https://goreleaser.com/customization/nfpm/
nfpms:
  - id: package
    package_name: "{{ .ProjectName }}"
    # file_name_template: "{{ .PackageName }}_{{ .Version }}-1.{{ .Os }}_{{ .Arch }}"
    file_name_template: "{{ .ConventionalFileName }}"
    builds:
      - prebuilt
    vendor: "{{ .Var.Vendor }}"
    homepage: "{{ .Var.VendorHomepage }}"
    maintainer: Northwood Labs <packages@northwood-labs.com>
    description: "{{ .Var.Description }}"
    license: "{{ .Var.License }}"
    formats:
      - apk
      - deb
      - rpm
    umask: 0o002
    release: 1
    rpm:
      summary: "{{ .Var.Description }}"
      packager: Northwood Labs <packages@northwood-labs.com>
      compression: lzma
      # signature:
      #   key_file: "{{ .Env.GPG_KEY_PATH }}"
    deb:
      # signature:
      #   key_file: "{{ .Env.GPG_KEY_PATH }}"
      #   type: origin
    apk:
      # signature:
      #   key_file: "{{ .Env.GPG_KEY_PATH }}"
      #   key_name: origin
